<mark>编码</mark> 编码是信息从一种形式或格式转换为另一种形式的过程。解码时编码的逆过程。

## 一、几种常见中文编码的关系

![image-20210710160627798](https://cdn.jsdelivr.net/gh/moon-Light404/my-picGo/img/202111022112091.png)

所谓兼容性可以简单理解为子集，同时存在也不冲突，不会出现上文所说的不知道是“腾讯”还是133号文字的情况。

图中我们可以看出，**ASCII被所有编码兼容**，而最常见的`UTF8与GBK之间除了ASCII部分之外没有交集，这也是平时业务中最常见的导致乱码场景，使用`UTF8`去读取`GBK`编码的文字，可能会看到各种乱码。而GB系列的几种编码，`**GB18030兼容GBK，GBK又兼容GB2312**`，下文细讲。





## 二、ASCII编码

ASCII编码每个字母或符号占`1byte(8bits)`，并且`8bit`的最高位是0，因此ASCII能编码的字母和符号只有128个。有一些编码把8`bits`最高位为1的后128个值也编码上，使得1`byte`可以表示256个值，但是这属于扩展的ASCII，并非标准ASCII。

ASCII编码几乎被世界上所有编码所兼容（`UTF16和UTF32`是个例外），因此如果一个文本文档里面的内容全都由ASCII里面的字母或符号构成，那么不管你如何展示该文档的内容，都不可能出现乱码的情况。



## 三、`GB2321、GBK、GB18030`编码

GB全程国标，GBK全称国标扩展。

### [GB2312]

最早一版的中文编码，**每个字占据2bytes**。由于要和ASCII兼容，那这2bytes最高位不可以为0了（否则和ASCII会有冲突）。在GB2312中收录了6763个汉字以及682个特殊符号，已经囊括了生活中最常用的所有汉字。（GB2312编码全表：[链接](https://link.zhihu.com/?target=http%3A//tools.jb51.net/table/gb2312)）

GB2312编码表有个值得注意的点，这个表中也有一些数字和字母，与ASCII里面的字母非常像。例如A3B2对应的是数字2（如下图），但是ASCII里面50（十进制）对应的也是数字2。他们的区别就是输入法中所说的**“半角”和“全角”**。全角的数字2占两个字节。

通常，我们在打字或编程中都使用半角，即ASCII来编写数字或英文字母。特别是编程中，如果写全角的数字或字母，编译器很有可能不认识……



### [GBK]

对GBK2312的扩充，也是2byte编码



### [GB18030]

**GB18030多出来的汉字使用4bytes编码。**当然，为了兼容GBK，这个四字节的前两位显然不能与GBK冲突（实操中发现后两位也并没有和GBK冲突）。





## 为什么兼容？

GB2321，GBK，GB18030都是采取了固定长度的办法来解决字符分隔问题。GBK和GB2312比ASCII多出来的字都是2bytes，GB18030比GBK多出来的字都是4byte。(GBK，GB2321的2byte最高位不可以为0，否则和ASCII会有冲突)。





## 五、UTF8编码

UTF8可以表示出世界上所有的文字。UTF9与GB系列编码不兼容，所以如果一个文件中即有UTF8编码的文字，又有GB18030编码的文字，那绝对会乱码。

Unicode赋予了全世界所有文字和符号一个独一无二的数字编号，UTF8所做的事情就是把这个数字编号表示出来（即解决前文提到的第2件事情）。**UTF8解决字符间分隔的方式是数二进制中最高位连续1的个数来决定这个字是几字节编码。**0开头的属于单字节，和ASCII码重合，做到了兼容。

![image-20210710164531705](https://cdn.jsdelivr.net/gh/moon-Light404/my-picGo/img/202111022112185.png)

以三字节为例，开头第一个字节的”1110”，有连续三个1，说明包括本字节在内，接下来三个字节一起构成了一个文字。凡是不属于文字首字节的byte都以“10”开头，上表中标注X的位置才是真正用来表示Unicode数值的。

<mark>兼容ASCII</mark>

**对于中文汉字来说，所有常用汉字的Unicode值都可以用3字节的UTF8表示出来，而GBK编码的汉字基本是2字节**（GB18030虽4字节但是日常没人会写那些字）。这也就导致了，如果把GBK编码的中文文本另存为UTF8编码，体积会大50%左右。这也是**UTF8的一点小瑕疵，存储同样的汉字，体积比GBK要大50%。**